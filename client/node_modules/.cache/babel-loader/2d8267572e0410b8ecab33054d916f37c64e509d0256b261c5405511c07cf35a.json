{"ast":null,"code":"import TinderCard from'react-tinder-card';import{useEffect,useState}from'react';import ChatContainer from'../components/ChatContainer';import{useCookies}from'react-cookie';import axios from'axios';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const Dashboard=()=>{const[user,setUser]=useState(null);const[genderedUsers,setGenderedUsers]=useState(null);const[lastDirection,setLastDirection]=useState();const[cookies,setCookie,removeCookie]=useCookies(['user']);const userId=cookies.UserId;const getUser=async()=>{try{const response=await axios.get('http://localhost:8000/user',{params:{userId}});setUser(response.data);}catch(error){console.log(error);}};const getGenderedUsers=async()=>{try{const response=await axios.get('http://localhost:8000/gendered-users',{params:{gender:user===null||user===void 0?void 0:user.gender_interest}});setGenderedUsers(response.data);}catch(error){console.log(error);}};useEffect(()=>{getUser();},[]);useEffect(()=>{if(user){getGenderedUsers();}},[user]);const updateMatches=async matchedUserId=>{try{await axios.put('http://localhost:8000/addmatch',{userId,matchedUserId});getUser();}catch(err){console.log(err);}};const swiped=(direction,swipedUserId)=>{if(direction==='right'){updateMatches(swipedUserId);}setLastDirection(direction);};const outOfFrame=name=>{console.log(name+' left the screen!');};const matchedUserIds=user===null||user===void 0?void 0:user.matches.map(_ref=>{let{user_id}=_ref;return user_id;}).concat(userId);const filteredGenderedUsers=genderedUsers===null||genderedUsers===void 0?void 0:genderedUsers.filter(genderedUser=>!matchedUserIds.includes(genderedUser.user_id));console.log('filteredGenderedUsers ',filteredGenderedUsers);return/*#__PURE__*/_jsx(_Fragment,{children:user&&/*#__PURE__*/_jsxs(\"div\",{className:\"dashboard\",children:[/*#__PURE__*/_jsx(ChatContainer,{user:user}),/*#__PURE__*/_jsx(\"div\",{className:\"swipe-container\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"card-container\",children:[filteredGenderedUsers===null||filteredGenderedUsers===void 0?void 0:filteredGenderedUsers.map(genderedUser=>/*#__PURE__*/_jsx(TinderCard,{className:\"swipe\",onSwipe:dir=>swiped(dir,genderedUser.user_id),onCardLeftScreen:()=>outOfFrame(genderedUser.first_name),children:/*#__PURE__*/_jsx(\"div\",{style:{backgroundImage:\"url(\"+genderedUser.url+\")\"},className:\"card\",children:/*#__PURE__*/_jsx(\"h3\",{children:genderedUser.first_name})})},genderedUser.user_id)),/*#__PURE__*/_jsx(\"div\",{className:\"swipe-info\",children:lastDirection?/*#__PURE__*/_jsxs(\"p\",{children:[\"You swiped \",lastDirection]}):/*#__PURE__*/_jsx(\"p\",{})})]})})]})});};export default Dashboard;","map":{"version":3,"names":["TinderCard","useEffect","useState","ChatContainer","useCookies","axios","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Dashboard","user","setUser","genderedUsers","setGenderedUsers","lastDirection","setLastDirection","cookies","setCookie","removeCookie","userId","UserId","getUser","response","get","params","data","error","console","log","getGenderedUsers","gender","gender_interest","updateMatches","matchedUserId","put","err","swiped","direction","swipedUserId","outOfFrame","name","matchedUserIds","matches","map","_ref","user_id","concat","filteredGenderedUsers","filter","genderedUser","includes","children","className","onSwipe","dir","onCardLeftScreen","first_name","style","backgroundImage","url"],"sources":["/Users/apple/Documents/tinder-clone/client/src/pages/Dashboard.js"],"sourcesContent":["import TinderCard from 'react-tinder-card'\nimport {useEffect, useState} from 'react'\nimport ChatContainer from '../components/ChatContainer'\nimport {useCookies} from 'react-cookie'\nimport axios from 'axios'\n\nconst Dashboard = () => {\n    const [user, setUser] = useState(null)\n    const [genderedUsers, setGenderedUsers] = useState(null)\n    const [lastDirection, setLastDirection] = useState()\n    const [cookies, setCookie, removeCookie] = useCookies(['user'])\n\n    const userId = cookies.UserId\n\n\n    const getUser = async () => {\n        try {\n            const response = await axios.get('http://localhost:8000/user', {\n                params: {userId}\n            })\n            setUser(response.data)\n        } catch (error) {\n            console.log(error)\n        }\n    }\n    const getGenderedUsers = async () => {\n        try {\n            const response = await axios.get('http://localhost:8000/gendered-users', {\n                params: {gender: user?.gender_interest}\n            })\n            setGenderedUsers(response.data)\n        } catch (error) {\n            console.log(error)\n        }\n    }\n\n    useEffect(() => {\n        getUser()\n\n    }, [])\n\n    useEffect(() => {\n        if (user) {\n            getGenderedUsers()\n        }\n    }, [user])\n\n    const updateMatches = async (matchedUserId) => {\n        try {\n            await axios.put('http://localhost:8000/addmatch', {\n                userId,\n                matchedUserId\n            })\n            getUser()\n        } catch (err) {\n            console.log(err)\n        }\n    }\n\n\n    const swiped = (direction, swipedUserId) => {\n        if (direction === 'right') {\n            updateMatches(swipedUserId)\n        }\n        setLastDirection(direction)\n    }\n\n    const outOfFrame = (name) => {\n        console.log(name + ' left the screen!')\n    }\n\n    const matchedUserIds = user?.matches.map(({user_id}) => user_id).concat(userId)\n\n    const filteredGenderedUsers = genderedUsers?.filter(genderedUser => !matchedUserIds.includes(genderedUser.user_id))\n\n\n    console.log('filteredGenderedUsers ', filteredGenderedUsers)\n    return (\n        <>\n            {user &&\n            <div className=\"dashboard\">\n                <ChatContainer user={user}/>\n                <div className=\"swipe-container\">\n                    <div className=\"card-container\">\n\n                        {filteredGenderedUsers?.map((genderedUser) =>\n                            <TinderCard\n                                className=\"swipe\"\n                                key={genderedUser.user_id}\n                                onSwipe={(dir) => swiped(dir, genderedUser.user_id)}\n                                onCardLeftScreen={() => outOfFrame(genderedUser.first_name)}>\n                                <div\n                                    style={{backgroundImage: \"url(\" + genderedUser.url + \")\"}}\n                                    className=\"card\">\n                                    <h3>{genderedUser.first_name}</h3>\n                                </div>\n                            </TinderCard>\n                        )}\n                        <div className=\"swipe-info\">\n                            {lastDirection ? <p>You swiped {lastDirection}</p> : <p/>}\n                        </div>\n                    </div>\n                </div>\n            </div>}\n        </>\n    )\n}\nexport default Dashboard\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}